<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>/home/bm12/Desktop/repo/personal/liquidhaskell-ci/src/Lib.hs</title>
</head>
<head>
<link type='text/css' rel='stylesheet' href='liquid.css' />
</head>

<body>
<hr>
Put mouse over identifiers to see inferred types
<pre><span class=hs-linenum>  1: </span><a class=annot href="#"><span class=annottext>GHC.Types.Module</span><span class='hs-keyword'>module</span></a> <span class='hs-conid'>Lib</span> <span class='hs-keyword'>where</span>
<span class=hs-linenum>  2: </span>
<span class=hs-linenum>  3: </span><span class='hs-keyword'>import</span> <span class='hs-conid'>Prelude</span> <span class='hs-varid'>hiding</span> <span class='hs-layout'>(</span><span class='hs-varid'>replicate</span><span class='hs-layout'>,</span> <span class='hs-varid'>take</span><span class='hs-layout'>)</span>
<span class=hs-linenum>  4: </span>
<span class=hs-linenum>  5: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>realSize</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>  6: </span><span class='hs-definition'>realSize</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum>  7: </span><a class=annot href="#"><span class=annottext>x1:[a] -&gt; {VV : GHC.Types.Int | VV == Lib.realSize x1}</span><span class='hs-definition'>realSize</span></a> <span class='hs-conid'>[]</span>     <span class='hs-keyglyph'>=</span> <span class='hs-num'>0</span>
<span class=hs-linenum>  8: </span><span class='hs-definition'>realSize</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (1 : int)}</span><span class='hs-num'>1</span></a> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Int | v == x1 + x2}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>{VV : GHC.Types.Int | VV == Lib.realSize xs}</span><span class='hs-varid'>realSize</span></a> <span class='hs-varid'>xs</span>
<span class=hs-linenum>  9: </span>
<span class=hs-linenum> 10: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>data</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SL</span>
<span class=hs-linenum> 11: </span>  <span class='hs-layout'>{</span> <span class='hs-varid'>size</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Nat</span>
<span class=hs-linenum> 12: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>elems</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>realSize</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>size</span><span class='hs-layout'>}</span>
<span class=hs-linenum> 13: </span>  <span class='hs-layout'>}</span>
<span class=hs-linenum> 14: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 15: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>SL</span>
<span class=hs-linenum> 16: </span>  <span class='hs-layout'>{</span> <span class='hs-varid'>size</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 17: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>elems</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>a</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 18: </span>  <span class='hs-layout'>}</span>
<span class=hs-linenum> 19: </span>
<span class=hs-linenum> 20: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>okList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SListN</span> <span class='hs-conid'>String</span> <span class='hs-num'>1</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 21: </span><span class='hs-definition'>okList</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-conid'>String</span>
<span class=hs-linenum> 22: </span><a class=annot href="#"><span class=annottext>{v : (Lib.SList [GHC.Types.Char]) | Lib.size v == 1}</span><span class='hs-definition'>okList</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (1 : int)}</span><span class='hs-conid'>SL</span></a> <span class='hs-num'>1</span> <span class='hs-keyglyph'>[</span><span class='hs-str'>"cat"</span><span class='hs-keyglyph'>]</span>
<span class=hs-linenum> 23: </span><span class='hs-comment'>-- UNSAFE</span>
<span class=hs-linenum> 24: </span><span class='hs-comment'>-- badList = SL 1 []</span>
<span class=hs-linenum> 25: </span>
<span class=hs-linenum> 26: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 27: </span>
<span class=hs-linenum> 28: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>nil</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 29: </span><a class=annot href="#"><span class=annottext>{v : (Lib.SList a) | Lib.size v == 0}</span><span class='hs-definition'>nil</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (0 : int)}</span><span class='hs-conid'>SL</span></a> <span class='hs-num'>0</span> <span class='hs-conid'>[]</span>
<span class=hs-linenum> 30: </span>
<span class=hs-linenum> 31: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>cons</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>xs</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size xs + 1}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 32: </span><a class=annot href="#"><span class=annottext>a -&gt; x2:(Lib.SList a) -&gt; {v : (Lib.SList a) | Lib.size v == Lib.size v + 1}</span><span class='hs-definition'>cons</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>SL</span> <span class='hs-varid'>n</span> <span class='hs-varid'>xs</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[a] -&gt; {v : (Lib.SList a) | Lib.elems v == x1}</span><span class='hs-conid'>SL</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>n</span></a><a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Int | v == x1 + x2}</span><span class='hs-varop'>+</span></a><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 33: </span>
<span class=hs-linenum> 34: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>die</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{ v:</span><span class='hs-conid'>String</span> <span class='hs-keyword'>| false }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 35: </span><a class=annot href="#"><span class=annottext>{VV : [GHC.Types.Char] | false} -&gt; a</span><span class='hs-definition'>die</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (GHC.Classes.IP [GHC.Types.Char] GHC.Stack.Types.CallStack) | v == $dIP_a2oS}</span><span class='hs-varid'>error</span></a>
<span class=hs-linenum> 36: </span>
<span class=hs-linenum> 37: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>hd</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{ xs:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size xs &gt; 0 }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 38: </span><span class='hs-definition'>hd</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 39: </span><a class=annot href="#"><span class=annottext>{v : (Lib.SList a) | Lib.size v &gt; 0} -&gt; a</span><span class='hs-definition'>hd</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>SL</span> <span class='hs-keyword'>_</span> <span class='hs-layout'>(</span><span class='hs-varid'>x</span><span class='hs-conop'>:</span><span class='hs-keyword'>_</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>x</span>
<span class=hs-linenum> 40: </span><span class='hs-definition'>hd</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>die</span></a> <span class='hs-str'>"empty SList"</span>
<span class=hs-linenum> 41: </span>
<span class=hs-linenum> 42: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>tl</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{ xs:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size xs &gt; 0 }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size xs - 1}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 43: </span><a class=annot href="#"><span class=annottext>x1:{v : (Lib.SList a) | Lib.size v &gt; 0} -&gt; {v : (Lib.SList a) | Lib.size v == Lib.size x1 - 1}</span><span class='hs-definition'>tl</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>SL</span> <span class='hs-varid'>n</span> <span class='hs-layout'>(</span><span class='hs-keyword'>_</span><span class='hs-conop'>:</span><span class='hs-varid'>xs</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:[a] -&gt; {v : (Lib.SList a) | Lib.elems v == x1}</span><span class='hs-conid'>SL</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>n</span></a><a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Int | v == x1 - x2}</span><span class='hs-comment'>-</span></a><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>xs</span>
<span class=hs-linenum> 44: </span><span class='hs-definition'>tl</span> <span class='hs-keyword'>_</span>             <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>[GHC.Types.Char]</span><span class='hs-varid'>die</span></a> <span class='hs-str'>"empty SList"</span>
<span class=hs-linenum> 45: </span>
<span class=hs-linenum> 46: </span><span class='hs-keyword'>{-@</span>
<span class=hs-linenum> 47: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span>
<span class=hs-linenum> 48: </span>  <span class='hs-layout'>{</span> <span class='hs-varid'>front</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 49: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>back</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SListLE</span> <span class='hs-varid'>a</span> <span class='hs-layout'>(</span><span class='hs-varid'>size</span> <span class='hs-varid'>front</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 50: </span>  <span class='hs-layout'>}</span>
<span class=hs-linenum> 51: </span><span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 52: </span><span class='hs-keyword'>data</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>Q</span>
<span class=hs-linenum> 53: </span>  <span class='hs-layout'>{</span> <span class='hs-varid'>front</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 54: </span>  <span class='hs-layout'>,</span> <span class='hs-varid'>back</span>  <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 55: </span>  <span class='hs-layout'>}</span>
<span class=hs-linenum> 56: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>SListLE</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>size</span> <span class='hs-varid'>v</span> <span class='hs-varop'>&lt;=</span> <span class='hs-conid'>N</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 57: </span>
<span class=hs-linenum> 58: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>okQ</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Queue</span> <span class='hs-conid'>String</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 59: </span><span class='hs-definition'>okQ</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Queue</span> <span class='hs-conid'>String</span>
<span class=hs-linenum> 60: </span><a class=annot href="#"><span class=annottext>(Lib.Queue [GHC.Types.Char])</span><span class='hs-definition'>okQ</span></a>  <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:{v : (Lib.SList [GHC.Types.Char]) | Lib.size v &lt;= Lib.size Lib.okList} -&gt; {v : (Lib.Queue [GHC.Types.Char]) | Lib.sizeQ v == Lib.size Lib.okList + Lib.size x1
                                                                                                                 &amp;&amp; Lib.back v == x1
                                                                                                                 &amp;&amp; Lib.front v == Lib.okList}</span><span class='hs-conid'>Q</span></a> <span class='hs-varid'>okList</span> <span class='hs-varid'>nil</span>
<span class=hs-linenum> 61: </span>
<span class=hs-linenum> 62: </span><span class='hs-comment'>-- badQ = Q nil okList</span>
<span class=hs-linenum> 63: </span>
<span class=hs-linenum> 64: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>emp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>QueueN</span> <span class='hs-keyword'>_</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 65: </span><span class='hs-definition'>emp</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 66: </span><a class=annot href="#"><span class=annottext>{v : (Lib.Queue a) | Lib.sizeQ v == 0}</span><span class='hs-definition'>emp</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Lib.SList a) | Lib.size v == 0}</span><span class='hs-conid'>Q</span></a> <span class='hs-varid'>nil</span> <span class='hs-varid'>nil</span>
<span class=hs-linenum> 67: </span>
<span class=hs-linenum> 68: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>measure</span> <span class='hs-varid'>sizeQ</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 69: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>sizeQ</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>q</span><span class='hs-conop'>:</span><span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{ v:</span><span class='hs-conid'>Nat</span> <span class='hs-keyword'>| v = sizeQ q }</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 70: </span><span class='hs-definition'>sizeQ</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Int</span>
<span class=hs-linenum> 71: </span><a class=annot href="#"><span class=annottext>x1:(Lib.Queue a) -&gt; {v : GHC.Types.Int | v &gt;= 0
                                         &amp;&amp; v == Lib.sizeQ x1}</span><span class='hs-definition'>sizeQ</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Q</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0
                     &amp;&amp; v == Lib.size f}</span><span class='hs-varid'>size</span></a> <span class='hs-varid'>f</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Int | v == x1 + x2}</span><span class='hs-varop'>+</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0
                     &amp;&amp; v == Lib.size b}</span><span class='hs-varid'>size</span></a> <span class='hs-varid'>b</span>
<span class=hs-linenum> 72: </span>
<span class=hs-linenum> 73: </span><span class='hs-keyword'>{-@</span> <span class='hs-keyword'>type</span> <span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-conid'>N</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>{</span><span class='hs-varid'>v</span><span class='hs-conop'>:</span><span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>|</span> <span class='hs-varid'>sizeQ</span> <span class='hs-varid'>v</span> <span class='hs-keyglyph'>=</span> <span class='hs-conid'>N</span><span class='hs-layout'>}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 74: </span>
<span class=hs-linenum> 75: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>remove</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{ v:</span><span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| sizeQ v &gt; 0 }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{sizeQ v - 1}</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 76: </span><span class='hs-definition'>remove</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 77: </span><a class=annot href="#"><span class=annottext>x1:{v : (Lib.Queue a) | Lib.sizeQ v &gt; 0} -&gt; (a, {v : (Lib.Queue a) | Lib.sizeQ v == Lib.sizeQ x1 - 1})</span><span class='hs-definition'>remove</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Q</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>hd</span></a> <span class='hs-varid'>f</span><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>(Lib.SList a) -&gt; (Lib.Queue a)</span><span class='hs-varid'>makeq</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : (Lib.SList a) | Lib.size v == Lib.size f - 1}</span><span class='hs-varid'>tl</span></a> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 78: </span><span class='hs-comment'>-- remove (Q (SL n (x:xs)) b) = (x, makeq (SL (n-1) xs) b)</span>
<span class=hs-linenum> 79: </span>
<span class=hs-linenum> 80: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>okRemove</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 81: </span><span class='hs-definition'>okRemove</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-layout'>(</span><span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 82: </span><a class=annot href="#"><span class=annottext>(GHC.Num.Num a) =&gt; (a, (Lib.Queue a))</span><span class='hs-definition'>okRemove</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Lib.Queue a) | Lib.sizeQ v == 2}</span><span class='hs-varid'>remove</span></a> <span class='hs-varid'>example2Q</span>
<span class=hs-linenum> 83: </span>
<span class=hs-linenum> 84: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>example2Q</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>QueueN</span> <span class='hs-keyword'>_</span> <span class='hs-num'>2</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 85: </span><span class='hs-definition'>example2Q</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Num</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>=&gt;</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 86: </span><a class=annot href="#"><span class=annottext>(GHC.Num.Num a) =&gt; {v : (Lib.Queue a) | Lib.sizeQ v == 2}</span><span class='hs-definition'>example2Q</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:(Lib.SList a) -&gt; {v : (Lib.Queue a) | Lib.back v == x1}</span><span class='hs-conid'>Q</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Lib.SList a)</span><span class='hs-num'>1</span></a> <span class='hs-varop'>`cons`</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>(Lib.SList a)</span><span class='hs-num'>2</span></a> <span class='hs-varop'>`cons`</span> <span class='hs-varid'>nil</span><span class='hs-layout'>)</span><span class='hs-layout'>)</span> <span class='hs-varid'>nil</span>
<span class=hs-linenum> 87: </span>
<span class=hs-linenum> 88: </span><span class='hs-comment'>-- {-@ badRemove :: (a, Queue a) @-}</span>
<span class=hs-linenum> 89: </span><span class='hs-comment'>-- badRemove :: (a, Queue a)</span>
<span class=hs-linenum> 90: </span><span class='hs-comment'>-- badRemove = remove example0Q</span>
<span class=hs-linenum> 91: </span>
<span class=hs-linenum> 92: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>example0Q</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>QueueN</span> <span class='hs-keyword'>_</span> <span class='hs-num'>0</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 93: </span><span class='hs-definition'>example0Q</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 94: </span><a class=annot href="#"><span class=annottext>{v : (Lib.Queue a) | Lib.sizeQ v == 0}</span><span class='hs-definition'>example0Q</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : (Lib.SList a) | Lib.size v == 0}</span><span class='hs-conid'>Q</span></a> <span class='hs-varid'>nil</span> <span class='hs-varid'>nil</span>
<span class=hs-linenum> 95: </span>
<span class=hs-linenum> 96: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>insert</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>q</span><span class='hs-conop'>:</span><span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{sizeQ q + 1}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum> 97: </span><span class='hs-definition'>insert</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span>
<span class=hs-linenum> 98: </span><a class=annot href="#"><span class=annottext>a -&gt; x2:(Lib.Queue a) -&gt; {v : (Lib.Queue a) | Lib.sizeQ v == Lib.sizeQ v + 1}</span><span class='hs-definition'>insert</span></a> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>e</span></a> <span class='hs-layout'>(</span><span class='hs-conid'>Q</span> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:{v : (Lib.SList a) | Lib.size v &gt; Lib.size f =&gt; Lib.size v - Lib.size f == 1} -&gt; {v : (Lib.Queue a) | Lib.sizeQ v == Lib.size f + Lib.size x1}</span><span class='hs-varid'>makeq</span></a> <span class='hs-varid'>f</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : (Lib.SList a) | Lib.size v == Lib.size b + 1}</span><span class='hs-varid'>e</span></a> <span class='hs-varop'>`cons`</span> <span class='hs-varid'>b</span><span class='hs-layout'>)</span>
<span class=hs-linenum> 99: </span>
<span class=hs-linenum>100: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>replicate</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>n</span><span class='hs-conop'>:</span><span class='hs-conid'>Nat</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-varid'>n</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>101: </span><span class='hs-definition'>replicate</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>102: </span><a class=annot href="#"><span class=annottext>x1:{v : GHC.Types.Int | v &gt;= 0} -&gt; a -&gt; {v : (Lib.Queue a) | Lib.sizeQ v == x1}</span><span class='hs-definition'>replicate</span></a> <span class='hs-num'>0</span> <span class='hs-keyword'>_</span> <span class='hs-keyglyph'>=</span> <span class='hs-varid'>emp</span>
<span class=hs-linenum>103: </span><span class='hs-definition'>replicate</span> <span class='hs-varid'>n</span> <span class='hs-varid'>x</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:(Lib.Queue a) -&gt; {v : (Lib.Queue a) | Lib.sizeQ v == Lib.sizeQ x1 + 1}</span><span class='hs-varid'>insert</span></a> <span class='hs-varid'>x</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>x1:{v : GHC.Types.Int | v &gt;= 0} -&gt; a -&gt; {v : (Lib.Queue a) | Lib.sizeQ v == x1}</span><span class='hs-varid'>replicate</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>n</span></a><a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Int | v == x1 - x2}</span><span class='hs-comment'>-</span></a><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>x</span><span class='hs-layout'>)</span>
<span class=hs-linenum>104: </span>
<span class=hs-linenum>105: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>y3</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>QueueN</span> <span class='hs-keyword'>_</span> <span class='hs-num'>3</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>106: </span><a class=annot href="#"><span class=annottext>{v : (Lib.Queue [GHC.Types.Char]) | Lib.sizeQ v == 3}</span><span class='hs-definition'>y3</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (3 : int)}</span><span class='hs-varid'>replicate</span></a> <span class='hs-num'>3</span> <span class='hs-str'>"Yeah!"</span>
<span class=hs-linenum>107: </span>
<span class=hs-linenum>108: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>makeq</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>f</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{b:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| size b &gt; size f =&gt; size b - size f = 1 }</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size f + size b}</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>109: </span><span class='hs-definition'>makeq</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>110: </span><a class=annot href="#"><span class=annottext>x1:(Lib.SList a) -&gt; x2:{b : (Lib.SList a) | Lib.size b &gt; Lib.size x1 =&gt; Lib.size b - Lib.size x1 == 1} -&gt; {v : (Lib.Queue a) | Lib.sizeQ v == Lib.size x1 + Lib.size v}</span><span class='hs-definition'>makeq</span></a> <a class=annot href="#"><span class=annottext>(Lib.SList a)</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{b : (Lib.SList a) | Lib.size b &gt; Lib.size f =&gt; Lib.size b - Lib.size f == 1}</span><span class='hs-varid'>b</span></a>
<span class=hs-linenum>111: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0
                     &amp;&amp; v == Lib.size b}</span><span class='hs-varid'>size</span></a> <span class='hs-varid'>b</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Bool | v &lt;=&gt; x1 &lt;= x2}</span><span class='hs-varop'>&lt;=</span></a> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0
                     &amp;&amp; v == Lib.size f}</span><span class='hs-varid'>size</span></a> <span class='hs-varid'>f</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:{v : (Lib.SList a) | Lib.size v &lt;= Lib.size f} -&gt; {v : (Lib.Queue a) | Lib.sizeQ v == Lib.size f + Lib.size x1
                                                                          &amp;&amp; Lib.back v == x1
                                                                          &amp;&amp; Lib.front v == f}</span><span class='hs-conid'>Q</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span>
<span class=hs-linenum>112: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>        <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:(Lib.SList a) -&gt; {v : (Lib.Queue a) | Lib.back v == x1}</span><span class='hs-conid'>Q</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>x1:{v : (Lib.SList a) | Lib.size v == Lib.size f + 1} -&gt; x2:(Lib.SList a) -&gt; {v : (Lib.SList a) | Lib.size v == (Lib.size f + Lib.size x1) + Lib.size x2}</span><span class='hs-varid'>rot</span></a> <span class='hs-varid'>f</span> <span class='hs-varid'>b</span> <span class='hs-varid'>nil</span><span class='hs-layout'>)</span> <span class='hs-varid'>nil</span>
<span class=hs-linenum>113: </span>
<span class=hs-linenum>114: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>rot</span> <span class='hs-keyglyph'>::</span> <span class='hs-varid'>f</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>b</span><span class='hs-conop'>:</span><span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size f + 1}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-varid'>tmp</span><span class='hs-conop'>:</span><span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SListN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{size f + size b + size tmp}</span>  <span class='hs-varop'>/</span> <span class='hs-keyglyph'>[</span><span class='hs-varid'>size</span> <span class='hs-varid'>f</span><span class='hs-keyglyph'>]</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>115: </span><span class='hs-definition'>rot</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>SList</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>116: </span><a class=annot href="#"><span class=annottext>x1:(Lib.SList a) -&gt; x2:{v : (Lib.SList a) | Lib.size v == Lib.size x1 + 1} -&gt; x3:(Lib.SList a) -&gt; {v : (Lib.SList a) | Lib.size v == (Lib.size x1 + Lib.size x2) + Lib.size x3}</span><span class='hs-definition'>rot</span></a> <a class=annot href="#"><span class=annottext>(Lib.SList a)</span><span class='hs-varid'>f</span></a> <a class=annot href="#"><span class=annottext>{v : (Lib.SList a) | Lib.size v == Lib.size f + 1}</span><span class='hs-varid'>b</span></a> <a class=annot href="#"><span class=annottext>(Lib.SList a)</span><span class='hs-varid'>a</span></a>
<span class=hs-linenum>117: </span>  <span class='hs-keyglyph'>|</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v &gt;= 0
                     &amp;&amp; v == Lib.size f}</span><span class='hs-varid'>size</span></a> <span class='hs-varid'>f</span> <a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Bool | v &lt;=&gt; x1 == x2}</span><span class='hs-varop'>==</span></a> <span class='hs-num'>0</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>hd</span></a> <span class='hs-varid'>b</span> <span class='hs-varop'>`cons`</span> <span class='hs-varid'>a</span>
<span class=hs-linenum>118: </span>  <span class='hs-keyglyph'>|</span> <span class='hs-varid'>otherwise</span>   <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>hd</span></a> <span class='hs-varid'>f</span> <span class='hs-varop'>`cons`</span> <a class=annot href="#"><span class=annottext>x1:(Lib.SList a) -&gt; x2:{v : (Lib.SList a) | Lib.size v == Lib.size x1 + 1} -&gt; x3:(Lib.SList a) -&gt; {v : (Lib.SList a) | Lib.size v == (Lib.size x1 + Lib.size x2) + Lib.size x3}</span><span class='hs-varid'>rot</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : (Lib.SList a) | Lib.size v == Lib.size f - 1}</span><span class='hs-varid'>tl</span></a> <span class='hs-varid'>f</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{v : (Lib.SList a) | Lib.size v == Lib.size b - 1}</span><span class='hs-varid'>tl</span></a> <span class='hs-varid'>b</span><span class='hs-layout'>)</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>hd</span></a> <span class='hs-varid'>b</span> <span class='hs-varop'>`cons`</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>119: </span>
<span class=hs-linenum>120: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>take</span> <span class='hs-keyglyph'>::</span> <span class='hs-keyword'>{n:</span><span class='hs-conid'>Int</span> <span class='hs-keyword'>| n &gt;= 0}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-keyword'>{q:</span><span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>| sizeQ q &gt;= n}</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-varid'>n</span><span class='hs-layout'>,</span> <span class='hs-conid'>QueueN</span> <span class='hs-varid'>a</span> <span class='hs-keyword'>{sizeQ q - n}</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>121: </span><span class='hs-definition'>take</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Int</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span> <span class='hs-keyglyph'>-&gt;</span> <span class='hs-layout'>(</span><span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span><span class='hs-layout'>,</span> <span class='hs-conid'>Queue</span> <span class='hs-varid'>a</span><span class='hs-layout'>)</span>
<span class=hs-linenum>122: </span><a class=annot href="#"><span class=annottext>x1:{n : GHC.Types.Int | n &gt;= 0} -&gt; x2:{q : (Lib.Queue a) | Lib.sizeQ q &gt;= x1} -&gt; ({v : (Lib.Queue a) | Lib.sizeQ v == x1}, {v : (Lib.Queue a) | Lib.sizeQ v == Lib.sizeQ x2 - x1})</span><span class='hs-definition'>take</span></a> <span class='hs-num'>0</span> <a class=annot href="#"><span class=annottext>(Lib.Queue a)</span><span class='hs-varid'>q</span></a> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><span class='hs-varid'>emp</span><span class='hs-layout'>,</span> <span class='hs-varid'>q</span><span class='hs-layout'>)</span>
<span class=hs-linenum>123: </span><span class='hs-definition'>take</span> <span class='hs-varid'>n</span> <span class='hs-varid'>q</span> <span class='hs-keyglyph'>=</span> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>x1:(Lib.Queue a) -&gt; {v : (Lib.Queue a) | Lib.sizeQ v == Lib.sizeQ x1 + 1}</span><span class='hs-varid'>insert</span></a> <span class='hs-varid'>x</span> <span class='hs-varid'>out</span><span class='hs-layout'>,</span> <span class='hs-varid'>q''</span><span class='hs-layout'>)</span>
<span class=hs-linenum>124: </span>  <span class='hs-keyword'>where</span>
<span class=hs-linenum>125: </span>    <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>a</span><span class='hs-varid'>x</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : (Lib.Queue a) | VV /= q
                      &amp;&amp; Lib.sizeQ VV == Lib.sizeQ q - 1}</span><span class='hs-varid'>q'</span></a><span class='hs-layout'>)</span>    <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>(a, {v : (Lib.Queue a) | Lib.sizeQ v == Lib.sizeQ q - 1})</span><span class='hs-varid'>remove</span></a> <span class='hs-varid'>q</span>
<span class=hs-linenum>126: </span>    <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>{VV : (Lib.Queue a) | VV /= q}</span><span class='hs-varid'>out</span></a><span class='hs-layout'>,</span> <a class=annot href="#"><span class=annottext>{VV : (Lib.Queue a) | VV /= q}</span><span class='hs-varid'>q''</span></a><span class='hs-layout'>)</span> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:{n : GHC.Types.Int | n &gt;= 0} -&gt; x2:{q : (Lib.Queue a) | Lib.sizeQ q &gt;= x1} -&gt; ({v : (Lib.Queue a) | Lib.sizeQ v == x1}, {v : (Lib.Queue a) | Lib.sizeQ v == Lib.sizeQ x2 - x1})</span><span class='hs-varid'>take</span></a> <span class='hs-layout'>(</span><a class=annot href="#"><span class=annottext>GHC.Types.Int</span><span class='hs-varid'>n</span></a><a class=annot href="#"><span class=annottext>x1:GHC.Types.Int -&gt; x2:GHC.Types.Int -&gt; {v : GHC.Types.Int | v == x1 - x2}</span><span class='hs-comment'>-</span></a><span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-varid'>q'</span>
<span class=hs-linenum>127: </span>
<span class=hs-linenum>128: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>okTake</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>QueueN</span> <span class='hs-conid'>String</span> <span class='hs-num'>2</span><span class='hs-layout'>,</span> <span class='hs-conid'>QueueN</span> <span class='hs-conid'>String</span> <span class='hs-num'>1</span><span class='hs-layout'>)</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>129: </span><span class='hs-definition'>okTake</span> <span class='hs-keyglyph'>::</span> <span class='hs-layout'>(</span><span class='hs-conid'>Queue</span> <span class='hs-conid'>String</span><span class='hs-layout'>,</span> <span class='hs-conid'>Queue</span> <span class='hs-conid'>String</span><span class='hs-layout'>)</span>
<span class=hs-linenum>130: </span><a class=annot href="#"><span class=annottext>({v : (Lib.Queue [GHC.Types.Char]) | Lib.sizeQ v == 2}, {v : (Lib.Queue [GHC.Types.Char]) | Lib.sizeQ v == 1})</span><span class='hs-definition'>okTake</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>{v : GHC.Types.Int | v == (2 : int)}</span><span class='hs-varid'>take</span></a> <span class='hs-num'>2</span> <span class='hs-varid'>exampleQ</span> <span class='hs-comment'>-- accept</span>
<span class=hs-linenum>131: </span>
<span class=hs-linenum>132: </span><span class='hs-comment'>-- badTake = take 10 exampleQ -- reject</span>
<span class=hs-linenum>133: </span>
<span class=hs-linenum>134: </span><span class='hs-keyword'>{-@</span> <span class='hs-varid'>exampleQ</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>QueueN</span> <span class='hs-conid'>String</span> <span class='hs-num'>3</span> <span class='hs-keyword'>@-}</span>
<span class=hs-linenum>135: </span><span class='hs-definition'>exampleQ</span> <span class='hs-keyglyph'>::</span> <span class='hs-conid'>Queue</span> <span class='hs-conid'>String</span>
<span class=hs-linenum>136: </span><a class=annot href="#"><span class=annottext>{v : (Lib.Queue [GHC.Types.Char]) | Lib.sizeQ v == 3}</span><span class='hs-definition'>exampleQ</span></a> <span class='hs-keyglyph'>=</span> <a class=annot href="#"><span class=annottext>x1:(Lib.Queue [GHC.Types.Char]) -&gt; {v : (Lib.Queue [GHC.Types.Char]) | Lib.sizeQ v == Lib.sizeQ x1 + 1}</span><span class='hs-varid'>insert</span></a> <span class='hs-str'>"nal"</span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>x1:(Lib.Queue [GHC.Types.Char]) -&gt; {v : (Lib.Queue [GHC.Types.Char]) | Lib.sizeQ v == Lib.sizeQ x1 + 1}</span><span class='hs-varid'>insert</span></a> <span class='hs-str'>"bob"</span> <span class='hs-varop'>$</span> <a class=annot href="#"><span class=annottext>x1:(Lib.Queue [GHC.Types.Char]) -&gt; {v : (Lib.Queue [GHC.Types.Char]) | Lib.sizeQ v == Lib.sizeQ x1 + 1}</span><span class='hs-varid'>insert</span></a> <span class='hs-str'>"alice"</span> <span class='hs-varop'>$</span> <span class='hs-varid'>emp</span></pre>
</body>
</html>